<% breadcrumb @song %>
<% javascript 'simple-slider', 'song' %>
<div class="box-list song-box song-spec clear-block">
  <div class="float-right" style="padding-right:16px;">
    <div class="tracks-arrow active"></div>
  </div>
  <div class="simple-list">
    <div class="top-box clear-block">
      <div class="float-right" style="padding-right:56px;">
        <div class="track-tab">
          <span class="tracks-number"><span><%= @song.tracks.count %></span></span>
        </div>
      </div>
      <div class="bottom-box clear-block">
				<h1><%= @song.title %></h1>
        <div class="clear-block">
          <p class="music-info float-right align-right">
            <span>runtime:<br /><strong><%= @song.length %></strong></span>
          </p>
          <p class="thumb"><%= link_to avatar_image(@song.user, :small), user_path(@song.user) %></p>
					<p>
						<span class="name"><%= link_to @song.user.nickname, user_path(@song.user) %></span><br/>
						<span class="abstract"><%= @song.original_author %></span><br/>
						<span class="title"><%= @song.title %></span>
					</p>
          <p class="grey-text clear-float"><%= @song.description %></p>
          <p class="thumb">
            <%- @song.tracks.each do |track| -%>
              <%= track_instrument_icon(track) %>
            <%- end -%>
          </p>
          <div class="clearer"></div>
          <p class="genre"><%= link_to(@song.genre.name, genre_path(@song.genre)) if @song.genre %></p>
          <div class="music-info song-resume float-right">
            <%= rating(@song) %>
            <%= mlab_button(@song) %>
            <%= play_button(@song) %>
          </div>
          <div class="float-left">
            <%= download_button_for @song %>
            <%= download_link_for @song, 'DOWNLOAD' %>
          </div>
        </div>
      </div>
    </div>
    <div class="music-info song-stat">
      <p><strong>Stats</strong></p>
      <table width="100%" border="0" cellpadding="0" cellspacing="5" style="border-top:1px solid #E6E6E6;">
        <tr>
          <td width="40%">Play count</td>
          <td width="30%"><%= @song.listened_times %></td>
          <td width="20%">Rated</td>
          <td width="10%" class="align-right"><%= @song.rating_count %></td>
        </tr>
        <tr>
          <td width="40%">Edited</td>
          <td width="30%">15</td>
          <td width="20%">Created</td>
          <td width="10%" class="align-right"><%= @song.created_at.strftime("%m/%d/%y") %></td>
        </tr>
      </table>
    </div>
    <p class="abstract align-right" style="margin: 7px">
      <%- if logged_in? && !@has_abuse -%>
				<%= report_abuse_link_to formatted_new_song_abuse_path(@song, 'html') %>
      <%- end -%>
    </p>
  </div>
</div>

<div id="song-tracks-container" class="float-left one-col-big clear-block song-tracks">
  <div class="simple-list box-grigio-stondato">
    <div class="top-box clear-block">
			<div class="bottom-box clear-block slide-container">
				<div class="slide-clip">
					<div class="slide-contents">
						<%= render :partial => 'track', :collection => @song.tracks %>
					</div>
				</div>
      </div>
    </div>
  </div>
	<p class="align-right" style="margin-right: 9px">
		<a class="slide-prev" href="#"><%= image_tag 'move_arrow_up.png' %></a>
		<a class="slide-next" href="#"><%= image_tag 'move_arrow_down.png' %></a>
	</p>
</div>

<!-- TABMENU -->
<div class="tabmenu">
  <div class="tab active" id="direct-siblings-tab">
    <div class="sx"> </div>
    <div class="rp">
      <p class="siblings_green_text">
        <a href="#" onclick="$('indirect-siblings-tab').removeClassName('active');$('direct-siblings-tab').addClassName('active');$('indirect_siblings_container').hide();$('direct_siblings_container').show(); return false;">Other versions</a>
      </p>
			<p class="counter">(<%= @song.direct_siblings.size %>)</p>
    </div>
    <div class="dx"> </div>
  </div>
  <div class="tab" id="indirect-siblings-tab">
    <div class="sx"> </div>
    <div class="rp">
			<p class="siblings_orange_text"><a href="#" onclick="$('direct-siblings-tab').removeClassName('active');$('indirect-siblings-tab').addClassName('active');$('direct_siblings_container').hide();$('indirect_siblings_container').show(); return false;">Remote versions</a>
			</p>
			<p class="counter">(<%= @song.indirect_siblings.size %>)</p>
    </div>
    <div class="dx"> </div>
  </div>
</div>
<!-- END TABMENU -->

<div id="direct_siblings_container">
  <div class="box-list song-box special-list clear-block">
    <div class="simple-list">
      <div class="top-box clear-block">
        <div class="bottom-box clear-block" id="direct-siblings">
          <%= render :partial => 'sibling', :collection => @song.direct_siblings, :locals => { :container => 'direct-siblings' } %>
        </div>
      </div>
    </div>
  </div>

	<%= render :partial => 'siblings_container', :locals => { :container => 'direct-siblings', :empty => @song.direct_siblings.empty? } %>
</div>


<div id="indirect_siblings_container" style="display: none">
  <div class="box-list song-box special-list clear-block">
    <div class="simple-list">
      <div class="top-box clear-block">
        <div class="bottom-box clear-block">
          <div class="bottom-box clear-block" id="indirect-siblings">
            <%= render :partial => 'sibling', :collection => @song.indirect_siblings, :locals => { :container => 'indirect-siblings' } %>
          </div>
        </div>
      </div>
    </div>
  </div>

	<%= render :partial => 'siblings_container', :locals => { :container => 'indirect-siblings', :empty => @song.indirect_siblings.empty? } %>
</div>
